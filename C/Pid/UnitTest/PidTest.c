#include "../Pid.h"
#include <stdio.h>

#define NUMBER_OF_POINTS 300
float SinusArray[NUMBER_OF_POINTS] =
{
        0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,
        1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
        1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1, 1,1,1,1,1,1,1,1,1,1,
        1,1,1,1,1,1,1,1,1,1,

        2,2,2,2,2,2,2,2,2,2, 2,2,2,2,2,2,2,2,2,2, 2,2,2,2,2,2,2,2,2,2,
        2,2,2,2,2,2,2,2,2,2, 2,2,2,2,2,2,2,2,2,2, 2,2,2,2,2,2,2,2,2,2,
        0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,
        0,0,0,0,0,0,0,0,0,0,

        -2,-2,-2,-2,-2,-2,-2,-2,-2,-2, -2,-2,-2,-2,-2,-2,-2,-2,-2,-2, -2,-2,-2,-2,-2,-2,-2,-2,-2,-2,
        -2,-2,-2,-2,-2,-2,-2,-2,-2,-2, -2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,-2,
        0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,
        0,0,0,0,0,0,0,0,0,0,
};

void main()
{
    int it = 0;
    int Running = 1;
    float output = 0;
    float Input;
    Pid_DataType Pid;

    Pid_Init(&Pid, 4.0, -1023, 1023);
    Pid_SetParameters(&Pid, 0.4, 0.1, 0.10);
    while(Running)
    {
        Input = Pid_GetOutput(&Pid);
        Pid_SetSetpoint(&Pid, SinusArray[it + 1]);
        output = Pid_Handler(&Pid, Input);
        printf("%d, %f, %f\n", it, SinusArray[it + 1], output);
        if(it < NUMBER_OF_POINTS - 1)
        {
            it++;
        }
        else
        {
            it = 0;
            Running = 0;
        }
    }

    return;
}
